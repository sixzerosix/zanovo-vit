<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>

<body>
	<div class="relative bg-white rounded-lg shadow-xl p-8 w-full max-w-2xl" x-data="bankruptcyForm()">
		<button @click="resetForm()"
			class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 focus:outline-none">
			<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
			</svg>
		</button>

		<h1 class="text-3xl font-bold text-gray-900 mb-8">Узнайте Стоимость Процедуры Банкротства Прямо Сейчас!</h1>

		<form @submit.prevent="submitForm">
			<!-- Актуальная сумма долга? -->
			<div class="mb-6">
				<label class="block text-lg font-medium text-gray-900 mb-3">Актуальная сумма долга?</label>
				<div class="flex flex-wrap gap-3">
					<template x-for="option in debtOptions" :key="option.value">
						<button type="button" @click="debtAmount = option.value"
							:class="{ 'bg-[#0d1a2f] text-white': debtAmount === option.value, 'bg-white text-gray-700 border border-gray-300': debtAmount !== option.value }"
							class="px-5 py-2 rounded-full text-base font-medium transition-all duration-200 ease-in-out hover:bg-gray-100 hover:border-gray-400">
							<span x-text="option.label"></span>
						</button>
					</template>
				</div>
				<p x-cloak x-show="formSubmitted && !debtAmount" class="text-red-500 text-sm mt-1">Пожалуйста,
					выберите сумму долга.</p>
			</div>

			<!-- Есть ли просрочка на данный момент? -->
			<div class="mb-6">
				<label class="block text-lg font-medium text-gray-900 mb-3">Есть ли просрочка на данный
					момент?</label>
				<div class="flex flex-wrap gap-3">
					<template x-for="option in delinquencyOptions" :key="option.value">
						<button type="button" @click="hasDelinquency = option.value"
							:class="{ 'bg-[#0d1a2f] text-white': hasDelinquency === option.value, 'bg-white text-gray-700 border border-gray-300': hasDelinquency !== option.value }"
							class="px-5 py-2 rounded-full text-base font-medium transition-all duration-200 ease-in-out hover:bg-gray-100 hover:border-gray-400 flex items-center">
							<span x-show="hasDelinquency === option.value" class="mr-2">
								<svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"
									stroke-width="2">
									<path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
								</svg>
							</span>
							<span x-text="option.label"></span>
						</button>
					</template>
				</div>
				<p x-cloak x-show="formSubmitted && hasDelinquency === null" class="text-red-500 text-sm mt-1">
					Пожалуйста, укажите, есть ли просрочка.</p>
			</div>

			<!-- Какое имущество есть в собственности? -->
			<div class="mb-6">
				<label class="block text-lg font-medium text-gray-900 mb-3">Какое имущество есть в
					собственности?</label>
				<div class="flex flex-wrap gap-3 mb-4">
					<template x-for="option in propertyOptions" :key="option.value">
						<button type="button" @click="toggleProperty(option.value)"
							:class="{ 'bg-[#0d1a2f] text-white': selectedProperties.includes(option.value), 'bg-white text-gray-700 border border-gray-300': !selectedProperties.includes(option.value) }"
							class="px-5 py-2 rounded-full text-base font-medium transition-all duration-200 ease-in-out hover:bg-gray-100 hover:border-gray-400 flex items-center">
							<span x-show="selectedProperties.includes(option.value)" class="mr-2">
								<svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"
									stroke-width="2">
									<path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
								</svg>
							</span>
							<span x-text="option.label"></span>
						</button>
					</template>
				</div>
				<textarea x-model="otherProperty" placeholder="Ваш вариант" rows="4"
					class="mt-2 block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-base"></textarea>
			</div>

			<!-- Имя и Номер телефона -->
			<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
				<div>
					<label for="name" class="block text-lg font-medium text-gray-900 mb-2">Имя</label>
					<input type="text" id="name" x-model="name" placeholder="Ваше имя"
						class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-base">
					<p x-cloak x-show="formSubmitted && !name" class="text-red-500 text-sm mt-1">Пожалуйста, введите
						ваше имя.</p>
				</div>
				<div>
					<label for="phone" class="block text-lg font-medium text-gray-900 mb-2">Номер телефона</label>
					<input type="text" id="phone" x-model="phone" placeholder="+ 7" @input="formatPhoneNumber"
						class="block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-base">
					<p x-cloak x-show="formSubmitted && !phone" class="text-red-500 text-sm mt-1">Пожалуйста,
						введите номер телефона.</p>
					<p x-cloak x-show="formSubmitted && phone && !isPhoneValid" class="text-red-500 text-sm mt-1">
						Пожалуйста, введите корректный номер телефона (например, +7 (XXX) XXX-XX-XX).</p>
				</div>
			</div>

			<!-- Согласие на обработку персональных данных -->
			<div class="mb-8">
				<div class="flex items-start">
					<div class="flex items-center h-5">
						<input id="privacyPolicy" name="privacyPolicy" type="checkbox" x-model="privacyPolicyAccepted"
							class="focus:ring-blue-500 h-5 w-5 text-[#0d1a2f] border-gray-300 rounded form-checkbox">
					</div>
					<div class="ml-3 text-sm">
						<label for="privacyPolicy" class="font-medium text-gray-700 cursor-pointer">
							Нажимая кнопку отправить вы соглашаетесь с <a href="#"
								class="text-blue-600 hover:text-blue-800">политикой обработки персональных
								данных</a>
						</label>
					</div>
				</div>
				<p x-cloak x-show="formSubmitted && !privacyPolicyAccepted" class="text-red-500 text-sm mt-1">Вы
					должны согласиться с политикой обработки персональных данных.</p>
			</div>

			<!-- Кнопка Отправить -->
			<div>
				<button type="submit" :disabled="!isFormValid"
					:class="{ 'opacity-50 cursor-not-allowed': !isFormValid }"
					class="w-full inline-flex items-center justify-center px-6 py-3 border border-transparent rounded-full shadow-sm text-lg font-medium text-white bg-[#0d1a2f] hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200">
					Отправить
					<svg class="ml-3 -mr-1 h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"
						stroke-width="2">
						<path stroke-linecap="round" stroke-linejoin="round"
							d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3" />
					</svg>
				</button>
			</div>
		</form>
	</div>

	<script>
		document.addEventListener('alpine:init', () => {
			Alpine.data('bankruptcyForm', () => ({
				/** @type {string | null} */
				debtAmount: '500-800 тысяч', // Default selected
				/** @type {boolean | null} */
				hasDelinquency: false, // Default selected
				/** @type {string[]} */
				selectedProperties: ['Дом', 'Земля'], // Default selected
				/** @type {string} */
				otherProperty: '',
				/** @type {string} */
				name: '',
				/** @type {string} */
				phone: '',
				/** @type {boolean} */
				privacyPolicyAccepted: false,
				/** @type {boolean} */
				formSubmitted: false,

				debtOptions: [
					{ label: '300-500 тысяч', value: '300-500 тысяч' },
					{ label: '500-800 тысяч', value: '500-800 тысяч' },
					{ label: 'Более 800 тысяч', value: 'Более 800 тысяч' },
				],
				delinquencyOptions: [
					{ label: 'Да', value: true },
					{ label: 'Нет', value: false },
				],
				propertyOptions: [
					{ label: 'Квартира', value: 'Квартира' },
					{ label: 'Дом', value: 'Дом' },
					{ label: 'Земля', value: 'Земля' },
					{ label: 'Автомобиль', value: 'Автомобиль' },
					{ label: 'Коммерческая', value: 'Коммерческая' },
				],

				/**
				 * Toggles the selection of a property.
				 * @param {string} property
				 */
				toggleProperty(property) {
					if (this.selectedProperties.includes(property)) {
						this.selectedProperties = this.selectedProperties.filter(p => p !== property);
					} else {
						this.selectedProperties.push(property);
					}
				},

				/**
				 * Formats the phone number input.
				 */
				formatPhoneNumber() {
					let cleaned = ('' + this.phone).replace(/\D/g, '');
					let match = cleaned.match(/^(\d{1})(\d{3})(\d{3})(\d{2})(\d{2})$/);
					if (match) {
						this.phone = '+7 (' + match[2] + ') ' + match[3] + '-' + match[4] + '-' + match[5];
					} else if (cleaned.length > 1 && cleaned.startsWith('7')) {
						// If user starts with 7, assume +7
						this.phone = '+' + cleaned;
					} else if (cleaned.length > 0 && !cleaned.startsWith('7')) {
						this.phone = '+7 (' + cleaned; // Prepend +7 for other numbers
					} else {
						this.phone = cleaned;
					}
				},

				/**
				 * Checks if the phone number is valid.
				 * @returns {boolean}
				 */
				get isPhoneValid() {
					// Basic validation for +7 (XXX) XXX-XX-XX format
					return /^\+7 \(\d{3}\) \d{3}-\d{2}-\d{2}$/.test(this.phone);
				},

				/**
				 * Checks if the entire form is valid.
				 * @returns {boolean}
				 */
				get isFormValid() {
					return this.debtAmount !== null &&
						this.hasDelinquency !== null &&
						this.name.trim() !== '' &&
						this.phone.trim() !== '' &&
						this.isPhoneValid &&
						this.privacyPolicyAccepted;
				},

				/**
				 * Handles form submission.
				 */
				submitForm() {
					this.formSubmitted = true;
					if (this.isFormValid) {
						const formData = {
							debtAmount: this.debtAmount,
							hasDelinquency: this.hasDelinquency,
							selectedProperties: this.selectedProperties,
							otherProperty: this.otherProperty.trim(),
							name: this.name.trim(),
							phone: this.phone.trim(),
							privacyPolicyAccepted: this.privacyPolicyAccepted,
						};
						console.log('Form Submitted:', formData);
						alert('Форма успешно отправлена! Проверьте консоль для данных.');
						// In a real application, you would send this data to a server.
						// Example: fetch('/api/submit', { method: 'POST', body: JSON.stringify(formData) });
						this.resetForm();
					} else {
						alert('Пожалуйста, заполните все обязательные поля корректно.');
					}
				},

				/**
				 * Resets the form to its initial state.
				 */
				resetForm() {
					this.debtAmount = '500-800 тысяч';
					this.hasDelinquency = false;
					this.selectedProperties = ['Дом', 'Земля'];
					this.otherProperty = '';
					this.name = '';
					this.phone = '';
					this.privacyPolicyAccepted = false;
					this.formSubmitted = false;
				}
			}));
		});
	</script>
</body>

</html>